Perform a gap analysis of the current repository state against the required "Reference Architecture" and build stability requirements.

**Analyze the following specific files and configurations:**

1.  **Dependency Versions (`textbook/package.json`):**
    * **Check:** Is `tailwindcss` version 4 or 3? (Requirement: Must be v3).
    * **Check:** Are incompatible packages like `@tailwindcss/postcss` or `lightningcss` present? (Requirement: Must be removed).

2.  **Context Logic (`textbook/src/contexts/ChatContext.tsx`):**
    * **Check:** Does the file import from itself (`import ... from './ChatContext'`)? (Requirement: No circular imports).
    * **Check:** Are `ChatContextType` and `ChatMessage` defined inside the file? (Requirement: Yes).
    * **Check:** Are `ChatProvider` and `useChat` exported? (Requirement: Yes).

3.  **Component Structure (`textbook/src/components/`):**
    * **Check:** Do `ChatBot.tsx` and `TextSelectionButton.tsx` exist in this folder?
    * **Check:** Does `ChatBot.tsx` rely on internal state or does it consume `useChat`? (Requirement: Must consume `useChat`).

4.  **Global Integration (`textbook/src/theme/Root.tsx`):**
    * **Check:** Is the application wrapped with `<ChatProvider>`?
    * **Check:** Are `<ChatBot />` and `<TextSelectionButton />` rendered as siblings to `{children}`?

**Output:**
Generate a bulleted list of **"Missing Items"** and **"Critical Errors"** that must be resolved in the implementation phase.